SHUTDOWN(8)           Linux System Administrator's Manual          SHUTDOWN(8)

NNAAMMEE
       shutdown - bring the system down

SSYYNNOOPPSSIISS
       //ssbbiinn//sshhuuttddoowwnn [--aakkrrhhPPHHffFFnncc] [--tt _s_e_c] _t_i_m_e [_w_a_r_n_i_n_g _m_e_s_s_a_g_e]

DDEESSCCRRIIPPTTIIOONN
       sshhuuttddoowwnn  brings  the system down in a secure way.  All logged-in users
       are notified that the system is going down, and  llooggiinn(1)  is  blocked.
       It is possible to shut the system down immediately or after a specified
       delay.  All processes are first notified that the system is going  down
       by the signal SIGTERM.  This gives programs like vvii(1) the time to save
       the file being edited, mail and news processing programs  a  chance  to
       exit  cleanly,  etc.   sshhuuttddoowwnn  does  its  job  by signalling the iinniitt
       process, asking it to change the runlevel.  Runlevel 00 is used to  halt
       the  system, runlevel 66 is used to reboot the system, and runlevel SS is
       used to put to system into a state where administrative  tasks  can  be
       performed; this is the default if neither the _-_h or _-_r flag is given to
       sshhuuttddoowwnn.  To see which actions are taken on halt  or  reboot  see  the
       appropriate entries for these runlevels in the file _/_e_t_c_/_i_n_i_t_t_a_b.

OOPPTTIIOONNSS
       --aa     Use //eettcc//sshhuuttddoowwnn..aallllooww.

       --kk     Don't  really shutdown; only send the warning messages to every‐
              body.

       --rr     Reboot after shutdown.

       --hh     Equivalent to -P, unless -H is specified.

       --PP     Action is to power-off the machine.

       --HH     Action is to halt the machine.

       --ff     Skip fsck on reboot.

       --FF     Force fsck on reboot.

       --nn     [DEPRECATED] Don't call iinniitt(8) to do the  shutdown  but  do  it
              ourself.  The use of this option is discouraged, and its results
              are not always what you'd expect.

       --cc     Cancel a waiting shutdown. ("shutdown now" is  no  longer  wait‐
              ing.)  With this option it is of course not possible to give the
              time argument, but you can enter explanatory  message  arguments
              on the command line that will be sent to all users.

       --tt _s_e_c Tell  iinniitt(8)  to wait _s_e_c seconds between sending processes the
              warning and the kill signal, before  changing  to  another  run‐
              level.

       _t_i_m_e   When to shutdown.

       _w_a_r_n_i_n_g _m_e_s_s_a_g_e
              Message to send to all users.

       The  _t_i_m_e  argument  can  have  different formats.  First, it can be an
       absolute time in the format _h_h_:_m_m, in which _h_h is the hour (1 or 2 dig‐
       its)  and _m_m is the minute of the hour (in two digits).  Second, it can
       be in the format ++_m, in which _m is the number of minutes to wait.   The
       word nnooww is an alias for ++00.

       If  shutdown  is  called with a delay, it will create the advisory file
       _/_e_t_c_/_n_o_l_o_g_i_n which causes programs such as _l_o_g_i_n_(_1_) to  not  allow  new
       user  logins.  This  file  is  created five minutes before the shutdown
       sequence starts. Shutdown removes this file if it is stopped before  it
       can  signal  init  (i.e.  it is cancelled or something goes wrong).  It
       also removes it before calling init to change the runlevel.

       The --ff flag means `reboot fast'.  This only creates  an  advisory  file
       _/_f_a_s_t_b_o_o_t  which  can  be  tested by the system when it comes up again.
       The boot rc file can test if this file is present, and  decide  not  to
       run  ffsscckk(1)  since  the  system  has been shut down in the proper way.
       After that, the boot process should remove _/_f_a_s_t_b_o_o_t.

       The --FF flag means `force fsck'.  This only  creates  an  advisory  file
       _/_f_o_r_c_e_f_s_c_k  which  can  be tested by the system when it comes up again.
       The boot rc file can test if this file is present, and  decide  to  run
       ffsscckk(1)  with  a  special  `force' flag so that even properly unmounted
       file systems get checked.  After that, the boot process  should  remove
       _/_f_o_r_c_e_f_s_c_k.

       The  --nn  flag causes sshhuuttddoowwnn not to call iinniitt, but to kill all running
       processes itself.  sshhuuttddoowwnn will then turn off quota,  accounting,  and
       swapping and unmount all file systems.

AACCCCEESSSS CCOONNTTRROOLL
       sshhuuttddoowwnn  can  be  called from iinniitt(8) when the magic keys CCTTRRLL--AALLTT--DDEELL
       are pressed, by creating an appropriate  entry  in  _/_e_t_c_/_i_n_i_t_t_a_b.  This
       means that everyone who has physical access to the console keyboard can
       shut the system down. To prevent this, sshhuuttddoowwnn can check to see if  an
       authorized  user  is logged in on one of the virtual consoles. If sshhuutt‐‐
       ddoowwnn is called with the --aa argument (add  this  to  the  invocation  of
       shutdown  in  /etc/inittab),  it  checks  to see if the file _/_e_t_c_/_s_h_u_t_‐
       _d_o_w_n_._a_l_l_o_w is present.  It then compares the login names in  that  file
       with  the  list of people that are logged in on a virtual console (from
       _/_v_a_r_/_r_u_n_/_u_t_m_p). Only if one of those authorized users oorr rroooott is logged
       in, it will proceed. Otherwise it will write the message

       sshhuuttddoowwnn:: nnoo aauutthhoorriizzeedd uusseerrss llooggggeedd iinn

       to  the (physical) system console. The format of _/_e_t_c_/_s_h_u_t_d_o_w_n_._a_l_l_o_w is
       one user name per line. Empty lines and comment lines (prefixed by a ##)
       are allowed. Currently there is a limit of 32 users in this file.

       Note  that  if  _/_e_t_c_/_s_h_u_t_d_o_w_n_._a_l_l_o_w  is not present, the --aa argument is
       ignored.

HHAALLTT OORR PPOOWWEERROOFFFF
       The --HH option just sets the  _i_n_i_t  environment  variable  _I_N_I_T___H_A_L_T  to
       _H_A_L_T,  and the --PP option just sets that variable to _P_O_W_E_R_O_F_F. The shut‐
       down script that calls hhaalltt(8)  as  the  last  thing  in  the  shutdown
       sequence should check these environment variables and call hhaalltt(8) with
       the right options for  these  options  to  actually  have  any  effect.
       Debian 3.1 (sarge) supports this.

FFIILLEESS
       /fastboot
       /etc/inittab
       /etc/init.d/halt
       /etc/init.d/reboot
       /etc/shutdown.allow

NNOOTTEESS
       A lot of users forget to give the _t_i_m_e argument and are then puzzled by
       the error message sshhuuttddoowwnn produces. The _t_i_m_e argument is mandatory; in
       90 percent of all cases this argument will be the word nnooww.

       Init  can only capture CTRL-ALT-DEL and start shutdown in console mode.
       If the system is running the X window System, the  X  server  processes
       all  key  strokes.  Some  X11  environments make it possible to capture
       CTRL-ALT-DEL, but what exactly is done with that event depends on  that
       environment.

       Shutdown  wasn't  designed to be run setuid. /etc/shutdown.allow is not
       used to find out who is executing shutdown, it ONLY checks who is  cur‐
       rently logged in on (one of the) console(s).

AAUUTTHHOORR
       Miquel van Smoorenburg, miquels@cistron.nl

SSEEEE AALLSSOO
       ffsscckk(8), iinniitt(8), hhaalltt(8), ppoowweerrooffff(8), rreebboooott(8)

                               November 12, 2003                   SHUTDOWN(8)
